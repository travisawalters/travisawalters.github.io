<!DOCTYPE html>
<html>
<head>
    <title>ToolTrack</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: #333;
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .tabs {
            display: flex;
            background-color: #f4f4f4;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
        }
        
        .tab.active {
            background-color: white;
            border: 1px solid #ddd;
            border-bottom: none;
        }
        
        .tab-content {
            display: none;
            background-color: white;
            padding: 20px;
            border: 1px solid #ddd;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        button:hover {
            background-color: #45a049;
        }
        
        .tool-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .tool-card {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            background-color: white;
        }
        
        .tool-tag {
            display: inline-block;
            background-color: #eee;
            padding: 3px 8px;
            border-radius: 4px;
            margin-right: 5px;
            margin-bottom: 5px;
            font-size: 12px;
        }
        
        .tool-image {
            width: 100%;
            height: 150px;
            background-color: #f4f4f4;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
        }
        
        .tool-image img {
            max-width: 100%;
            max-height: 100%;
        }
        
        .search-bar {
            display: flex;
            margin-bottom: 20px;
            gap: 10px;
        }
        
        .search-bar input {
            flex: 2;
        }
        
        .search-bar select {
            flex: 1;
        }
    </style>
</head>
<body>
    <header>
        <h1>ToolTrack</h1>
        <p>Simple Tool Inventory System</p>
    </header>
    
    <div class="container">
        <div class="tabs" id="tabs">
            <div class="tab active" id="inventory-tab">Inventory</div>
            <div class="tab" id="add-tool-tab">Add Tool</div>
            <div class="tab" id="import-export-tab">Import/Export</div>
        </div>
        
        <div id="inventory-content" class="tab-content active">
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="Search tools...">
                <select id="category-filter">
                    <option value="">All Categories</option>
                    <option value="Hand Tools">Hand Tools</option>
                    <option value="Power Tools">Power Tools</option>
                    <option value="Garden Tools">Garden Tools</option>
                    <option value="Measuring Tools">Measuring Tools</option>
                    <option value="Other">Other</option>
                </select>
                <select id="tag-filter">
                    <option value="">All Tags</option>
                    <option value="Carpentry">Carpentry</option>
                    <option value="Plumbing">Plumbing</option>
                    <option value="Electrical">Electrical</option>
                    <option value="Automotive">Automotive</option>
                    <option value="Gardening">Gardening</option>
                </select>
            </div>
            
            <div id="tool-grid" class="tool-grid">
                <!-- Tools will be displayed here -->
                <div id="no-tools-message">No tools added yet. Use the "Add Tool" tab to get started.</div>
            </div>
        </div>
        
        <div id="add-tool-content" class="tab-content">
            <h2>Add New Tool</h2>
            <form id="tool-form">
                <div class="form-group">
                    <label for="tool-name">Tool Name *</label>
                    <input type="text" id="tool-name" required>
                </div>
                
                <div class="form-group">
                    <label for="tool-category">Category *</label>
                    <select id="tool-category" required>
                        <option value="">Select Category</option>
                        <option value="Hand Tools">Hand Tools</option>
                        <option value="Power Tools">Power Tools</option>
                        <option value="Garden Tools">Garden Tools</option>
                        <option value="Measuring Tools">Measuring Tools</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="tool-brand">Brand</label>
                    <input type="text" id="tool-brand">
                </div>
                
                <div class="form-group">
                    <label for="tool-model">Model</label>
                    <input type="text" id="tool-model">
                </div>
                
                <div class="form-group">
                    <label for="tool-serial">Serial Number</label>
                    <input type="text" id="tool-serial">
                </div>
                
                <div class="form-group">
                    <label for="tool-purchase-date">Purchase Date</label>
                    <input type="date" id="tool-purchase-date">
                </div>
                
                <div class="form-group">
                    <label for="tool-tags">Tags (comma separated)</label>
                    <input type="text" id="tool-tags" placeholder="Carpentry, Plumbing, etc.">
                </div>
                
                <div class="form-group">
                    <label for="tool-manual">Manual URL</label>
                    <input type="url" id="tool-manual" placeholder="https://...">
                </div>
                
                <div class="form-group">
                    <label for="tool-notes">Notes</label>
                    <textarea id="tool-notes" rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="tool-image">Image URL</label>
                    <input type="url" id="tool-image" placeholder="https://...">
                </div>
                
                <button type="button" id="save-tool-btn">Save Tool</button>
                <button type="button" id="clear-form-btn">Clear Form</button>
            </form>
        </div>
        
        <div id="import-export-content" class="tab-content">
            <h2>Import/Export Tools</h2>
            
            <div class="form-group">
                <h3>Export Tools</h3>
                <p>Download your tool inventory as a file.</p>
                <button type="button" id="export-json-btn">Export as JSON</button>
                <button type="button" id="export-csv-btn">Export as CSV</button>
            </div>
            
            <div class="form-group">
                <h3>Import Tools</h3>
                <p>Import tools from a file. This will replace your current inventory.</p>
                <input type="file" id="import-file" accept=".json,.csv">
                <button type="button" id="import-btn">Import</button>
            </div>
            
            <div class="form-group">
                <h3>Reset Inventory</h3>
                <p>Warning: This will delete all tools in your inventory.</p>
                <button type="button" id="reset-btn" style="background-color: #f44336;">Reset Inventory</button>
            </div>
        </div>
    </div>

    <script>
        // Wait for the DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM loaded");
            
            // Tool data
            let tools = [];
            let currentToolId = null;
            
            // Load tools from localStorage
            const savedTools = localStorage.getItem('tooltrack-tools');
            if (savedTools) {
                try {
                    tools = JSON.parse(savedTools);
                    renderTools();
                } catch (e) {
                    console.error("Error loading saved tools:", e);
                }
            }
            
            // Tab switching
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove active class from all tabs and contents
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Show corresponding content
                    const contentId = this.id.replace('-tab', '-content');
                    document.getElementById(contentId).classList.add('active');
                    
                    // Clear form when switching to add tool tab
                    if (this.id === 'add-tool-tab') {
                        clearForm();
                    }
                });
            });
            
            // Save tool button
            document.getElementById('save-tool-btn').addEventListener('click', function() {
                saveTool();
            });
            
            // Clear form button
            document.getElementById('clear-form-btn').addEventListener('click', function() {
                clearForm();
            });
            
            // Export buttons
            document.getElementById('export-json-btn').addEventListener('click', function() {
                exportTools('json');
            });
            
            document.getElementById('export-csv-btn').addEventListener('click', function() {
                exportTools('csv');
            });
            
            // Import button
            document.getElementById('import-btn').addEventListener('click', function() {
                importTools();
            });
            
            // Reset button
            document.getElementById('reset-btn').addEventListener('click', function() {
                resetInventory();
            });
            
            // Search and filters
            document.getElementById('search-input').addEventListener('input', filterTools);
            document.getElementById('category-filter').addEventListener('change', filterTools);
            document.getElementById('tag-filter').addEventListener('change', filterTools);
            
            // Functions
            
            // Save a tool
            function saveTool() {
                const name = document.getElementById('tool-name').value.trim();
                const category = document.getElementById('tool-category').value;
                
                if (!name || !category) {
                    alert('Please fill out the required fields (Name and Category).');
                    return;
                }
                
                const tool = {
                    id: currentToolId || Date.now().toString(),
                    name: name,
                    category: category,
                    brand: document.getElementById('tool-brand').value.trim(),
                    model: document.getElementById('tool-model').value.trim(),
                    serial: document.getElementById('tool-serial').value.trim(),
                    purchaseDate: document.getElementById('tool-purchase-date').value,
                    tags: document.getElementById('tool-tags').value.split(',').map(tag => tag.trim()).filter(tag => tag),
                    manual: document.getElementById('tool-manual').value.trim(),
                    notes: document.getElementById('tool-notes').value.trim(),
                    image: document.getElementById('tool-image').value.trim()
                };
                
                if (currentToolId) {
                    // Update existing tool
                    const index = tools.findIndex(t => t.id === currentToolId);
                    if (index !== -1) {
                        tools[index] = tool;
                    }
                } else {
                    // Add new tool
                    tools.push(tool);
                }
                
                // Save to localStorage
                localStorage.setItem('tooltrack-tools', JSON.stringify(tools));
                
                // Render tools
                renderTools();
                
                // Clear form and switch to inventory tab
                clearForm();
                document.getElementById('inventory-tab').click();
                
                alert('Tool saved successfully!');
            }
            
            // Clear the form
            function clearForm() {
                document.getElementById('tool-form').reset();
                currentToolId = null;
            }
            
            // Render tools in the grid
            function renderTools() {
                const grid = document.getElementById('tool-grid');
                const noTools = document.getElementById('no-tools-message');
                
                if (tools.length === 0) {
                    grid.innerHTML = '';
                    grid.appendChild(noTools);
                    return;
                }
                
                // Remove no tools message
                if (noTools.parentNode === grid) {
                    grid.removeChild(noTools);
                }
                
                // Create HTML for each tool
                grid.innerHTML = '';
                tools.forEach(tool => {
                    const card = document.createElement('div');
                    card.className = 'tool-card';
                    
                    let html = `
                        <div class="tool-image">
                            ${tool.image ? `<img src="${tool.image}" alt="${tool.name}">` : 'No Image'}
                        </div>
                        <h3>${tool.name}</h3>
                        <p><strong>Category:</strong> ${tool.category}</p>
                    `;
                    
                    if (tool.brand) {
                        html += `<p><strong>Brand:</strong> ${tool.brand}</p>`;
                    }
                    
                    if (tool.model) {
                        html += `<p><strong>Model:</strong> ${tool.model}</p>`;
                    }
                    
                    if (tool.tags && tool.tags.length > 0) {
                        html += `<div class="tool-tags">`;
                        tool.tags.forEach(tag => {
                            html += `<span class="tool-tag">${tag}</span>`;
                        });
                        html += `</div>`;
                    }
                    
                    html += `
                        <div style="margin-top: 10px;">
                            <button onclick="editTool('${tool.id}')">Edit</button>
                            <button onclick="deleteTool('${tool.id}')" style="background-color: #f44336;">Delete</button>
                        </div>
                    `;
                    
                    card.innerHTML = html;
                    grid.appendChild(card);
                });
            }
            
            // Filter tools
            function filterTools() {
                const search = document.getElementById('search-input').value.toLowerCase();
                const category = document.getElementById('category-filter').value;
                const tag = document.getElementById('tag-filter').value;
                
                const filteredTools = tools.filter(tool => {
                    const searchMatch = !search || 
                        tool.name.toLowerCase().includes(search) || 
                        (tool.brand && tool.brand.toLowerCase().includes(search)) || 
                        (tool.model && tool.model.toLowerCase().includes(search)) || 
                        (tool.notes && tool.notes.toLowerCase().includes(search));
                    
                    const categoryMatch = !category || tool.category === category;
                    
                    const tagMatch = !tag || (tool.tags && tool.tags.includes(tag));
                    
                    return searchMatch && categoryMatch && tagMatch;
                });
                
                // Create HTML for filtered tools
                const grid = document.getElementById('tool-grid');
                const noTools = document.getElementById('no-tools-message');
                
                if (filteredTools.length === 0) {
                    grid.innerHTML = '<p>No tools match your filters.</p>';
                    return;
                }
                
                // Remove no tools message
                if (noTools.parentNode === grid) {
                    grid.removeChild(noTools);
                }
                
                // Create HTML for each tool
                grid.innerHTML = '';
                filteredTools.forEach(tool => {
                    const card = document.createElement('div');
                    card.className = 'tool-card';
                    
                    let html = `
                        <div class="tool-image">
                            ${tool.image ? `<img src="${tool.image}" alt="${tool.name}">` : 'No Image'}
                        </div>
                        <h3>${tool.name}</h3>
                        <p><strong>Category:</strong> ${tool.category}</p>
                    `;
                    
                    if (tool.brand) {
                        html += `<p><strong>Brand:</strong> ${tool.brand}</p>`;
                    }
                    
                    if (tool.model) {
                        html += `<p><strong>Model:</strong> ${tool.model}</p>`;
                    }
                    
                    if (tool.tags && tool.tags.length > 0) {
                        html += `<div class="tool-tags">`;
                        tool.tags.forEach(tag => {
                            html += `<span class="tool-tag">${tag}</span>`;
                        });
                        html += `</div>`;
                    }
                    
                    html += `
                        <div style="margin-top: 10px;">
                            <button onclick="editTool('${tool.id}')">Edit</button>
                            <button onclick="deleteTool('${tool.id}')" style="background-color: #f44336;">Delete</button>
                        </div>
                    `;
                    
                    card.innerHTML = html;
                    grid.appendChild(card);
                });
            }
            
            // Export tools
            function exportTools(format) {
                if (tools.length === 0) {
                    alert('No tools to export.');
                    return;
                }
                
                let content, filename, type;
                
                if (format === 'json') {
                    content = JSON.stringify(tools, null, 2);
                    filename = 'tooltrack-export.json';
                    type = 'application/json';
                } else {
                    // CSV format
                    const headers = ['Name', 'Category', 'Brand', 'Model', 'Serial', 'Purchase Date', 'Tags', 'Manual', 'Notes', 'Image'];
                    let csv = headers.join(',') + '\n';
                    
                    tools.forEach(tool => {
                        const row = [
                            `"${(tool.name || '').replace(/"/g, '""')}"`,
                            `"${(tool.category || '').replace(/"/g, '""')}"`,
                            `"${(tool.brand || '').replace(/"/g, '""')}"`,
                            `"${(tool.model || '').replace(/"/g, '""')}"`,
                            `"${(tool.serial || '').replace(/"/g, '""')}"`,
                            `"${(tool.purchaseDate || '')}"`,
                            `"${(tool.tags || []).join(';').replace(/"/g, '""')}"`,
                            `"${(tool.manual || '').replace(/"/g, '""')}"`,
                            `"${(tool.notes || '').replace(/"/g, '""')}"`,
                            `"${(tool.image || '').replace(/"/g, '""')}"`
                        ];
                        csv += row.join(',') + '\n';
                    });
                    
                    content = csv;
                    filename = 'tooltrack-export.csv';
                    type = 'text/csv';
                }
                
                // Create download link
                const blob = new Blob([content], { type });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
            
            // Import tools
            function importTools() {
                const fileInput = document.getElementById('import-file');
                const file = fileInput.files[0];
                
                if (!file) {
                    alert('Please select a file to import.');
                    return;
                }
                
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        if (file.name.endsWith('.json')) {
                            const importedTools = JSON.parse(e.target.result);
                            
                            if (!Array.isArray(importedTools)) {
                                throw new Error('Invalid JSON format. Expected an array of tools.');
                            }
                            
                            if (confirm(`Import ${importedTools.length} tools? This will replace your current inventory.`)) {
                                tools = importedTools;
                                localStorage.setItem('tooltrack-tools', JSON.stringify(tools));
                                renderTools();
                                alert('Tools imported successfully!');
                                fileInput.value = '';
                            }
                        } else if (file.name.endsWith('.csv')) {
                            // Simple CSV parsing
                            const lines = e.target.result.split('\n');
                            const headers = lines[0].split(',');
                            
                            const importedTools = [];
                            
                            for (let i = 1; i < lines.length; i++) {
                                if (!lines[i].trim()) continue;
                                
                                const values = lines[i].split(',');
                                const tool = {
                                    id: Date.now().toString() + i,
                                    name: values[0]?.replace(/^"|"$/g, '') || '',
                                    category: values[1]?.replace(/^"|"$/g, '') || '',
                                    brand: values[2]?.replace(/^"|"$/g, '') || '',
                                    model: values[3]?.replace(/^"|"$/g, '') || '',
                                    serial: values[4]?.replace(/^"|"$/g, '') || '',
                                    purchaseDate: values[5]?.replace(/^"|"$/g, '') || '',
                                    tags: (values[6]?.replace(/^"|"$/g, '') || '').split(';').filter(tag => tag.trim()),
                                    manual: values[7]?.replace(/^"|"$/g, '') || '',
                                    notes: values[8]?.replace(/^"|"$/g, '') || '',
                                    image: values[9]?.replace(/^"|"$/g, '') || ''
                                };
                                
                                importedTools.push(tool);
                            }
                            
                            if (confirm(`Import ${importedTools.length} tools? This will replace your current inventory.`)) {
                                tools = importedTools;
                                localStorage.setItem('tooltrack-tools', JSON.stringify(tools));
                                renderTools();
                                alert('Tools imported successfully!');
                                fileInput.value = '';
                            }
                        } else {
                            alert('Unsupported file format. Please use JSON or CSV.');
                        }
                    } catch (error) {
                        alert('Error importing file: ' + error.message);
                    }
                };
                
                reader.readAsText(file);
            }
            
            // Reset inventory
            function resetInventory() {
                if (confirm('Are you sure you want to delete ALL tools? This cannot be undone.')) {
                    tools = [];
                    localStorage.setItem('tooltrack-tools', JSON.stringify(tools));
                    renderTools();
                    alert('Inventory has been reset.');
                }
            }
            
            // Edit tool - making this global so the onclick attribute works
            window.editTool = function(id) {
                const tool = tools.find(t => t.id === id);
                if (!tool) return;
                
                // Set current tool ID
                currentToolId = id;
                
                // Fill form with tool data
                document.getElementById('tool-name').value = tool.name || '';
                document.getElementById('tool-category').value = tool.category || '';
                document.getElementById('tool-brand').value = tool.brand || '';
                document.getElementById('tool-model').value = tool.model || '';
                document.getElementById('tool-serial').value = tool.serial || '';
                document.getElementById('tool-purchase-date').value = tool.purchaseDate || '';
                document.getElementById('tool-tags').value = (tool.tags || []).join(', ');
                document.getElementById('tool-manual').value = tool.manual || '';
                document.getElementById('tool-notes').value = tool.notes || '';
                document.getElementById('tool-image').value = tool.image || '';
                
                // Switch to add tool tab
                document.getElementById('add-tool-tab').click();
            };
            
            // Delete tool - making this global so the onclick attribute works
            window.deleteTool = function(id) {
                if (confirm('Are you sure you want to delete this tool?')) {
                    tools = tools.filter(t => t.id !== id);
                    localStorage.setItem('tooltrack-tools', JSON.stringify(tools));
                    renderTools();
                }
            };
        });
    </script>
</body>
</html>
